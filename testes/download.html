<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <span id="text-to-download">Sou um texto para download</span>
    <button onclick="download()">DOWN</button>

    <script id="jszip" src="js/jszip.min.js"></script>
    <script>
        function download() {
            const zip = new JSZip();
            const textToDownload = document.getElementById('text-to-download').innerHTML
            
            zip.file("import.cmd", textToDownload) //configura file
            
            if (JSZip.support.blob){
                zip.generateAsync({type: 'blob'}) //gera arquivo
                    .then(function(data){
                        // const url = window.URL.createObjectURL(data)
                        // const a = document.createElement('a')
                        // a.href = url
                        // a.download = 'TaticView.zip'
                        // a.style.visibility = 'hidden'
                        // document.body.appendChild(a)
                        // a.click()
                        // document.body.removeChild(a)
                        // window.URL.revokeObjectURL(url)

                        window.navigator.msSaveOrOpenBlob(data, 'TaticIE.zip')
                    })
            } else {
                throw new Error('Browser not supported!!!!')
            }
            
        }
        
        
        
        // function download(content, fileName) {
            
        //     const file = new File([content], 'teste', {type: 'application/cmd'})
            
        //     const url = window.URL.createObjectURL(file)
        //     const a = document.createElement('a')
        //     a.href = url
        //     a.download = fileName
        //     a.click()
        // }

        
        
        
    </script>
</body>
</html>